<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:open18="http://java.sun.com/jsf/composite/components"
                template="layout/template.xhtml">

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="courseId" value="#{courseAction.courseId}"/>
            <f:event type="preRenderView" listener="#{courseAction.loadCourse}"/> <!-- TODO move the logic in setCourseId to this method -->
        </f:metadata>
    </ui:define>

    <ui:define name="body">

    <h:messages globalOnly="true" styleClass="message" errorClass="errormsg" infoClass="infomsg" warnClass="warnmsg"
                id="globalMessages"/>

        <h:form id="course" styleClass="edit">

            <rich:panel>
                <f:facet name="header">#{courseAction.managed ? 'Edit' : 'Add'} Course</f:facet>

                <open18:input id="descriptionDecoration" label="description">
                    <h:inputTextarea id="description"
                                     cols="80"
                                     rows="3"
                                     value="#{courseAction.course.description}"/>
                </open18:input>

                <open18:input id="designerDecoration" label="designer">
                    <h:inputText id="designer"
                                 size="50"
                                 maxlength="50"
                                 value="#{courseAction.course.designer}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="fairwaysDecoration" label="fairways">
                    <h:inputText id="fairways"
                                 required="true"
                                 size="15"
                                 maxlength="15"
                                 value="#{courseAction.course.fairways}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="greensDecoration" label="greens">
                    <h:inputText id="greens"
                                 required="true"
                                 size="15"
                                 maxlength="15"
                                 value="#{courseAction.course.greens}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="nameDecoration" label="name">
                    <h:inputText id="name"
                                 size="50"
                                 maxlength="50"
                                 value="#{courseAction.course.name}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="numHolesDecoration" label="numHoles">
                    <h:inputText id="numHoles"
                                 required="true"
                                 value="#{courseAction.course.numHoles}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="signatureHoleDecoration" label="signatureHole">
                    <h:inputText id="signatureHole"
                                 value="#{courseAction.course.signatureHole}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <open18:input id="yearBuiltDecoration" label="yearBuilt">
                    <h:inputText id="yearBuilt"
                                 value="#{courseAction.course.yearBuilt}">
                        <a:ajax event="blur" render="@region" bypassUpdates="true" execute="@region"/>
                    </h:inputText>
                </open18:input>

                <div style="clear:both">
                    <span class="required">*</span>
                    required fields
                </div>

            </rich:panel>

            <div class="actionButtons">

                <h:commandButton id="save"
                                 value="Save"
                                 action="#{courseAction.save}"
                                 rendered="#{!courseAction.managed}"/>

                <h:commandButton id="update"
                                 value="Update"
                                 action="#{courseAction.update}"
                                 rendered="#{courseAction.managed}"/>

                <h:commandButton id="delete"
                                 value="Delete"
                                 action="#{courseAction.remove}"
                                 immediate="true"
                                 rendered="#{courseAction.managed}"/>

                <h:button id="cancel"
                          value="Cancel"
                          outcome="/CourseList.xhtml"/>
            </div>

            <rich:tabPanel switchType="ajax">

                <rich:tab  header="facility *" headerClass="required">
                    <div class="association" id="facilityParent">

                        <h:outputText value="There is no facility associated with this course."
                                      rendered="#{courseAction.course.facility == null}"/>

                        <rich:dataTable var="_facility"
                                        value="#{courseAction.course.facility}"
                                        rendered="#{courseAction.course.facility != null}"
                                        rowClasses="rvgRowOne,rvgRowTwo"
                                        id="facilityTable">
                            <h:column>
                                <f:facet name="header">id</f:facet>
                                #{_facility.id}
                            </h:column>
                            <h:column>
                                <f:facet name="header">address</f:facet>
                                #{_facility.address}
                            </h:column>
                            <h:column>
                                <f:facet name="header">city</f:facet>
                                #{_facility.city}
                            </h:column>
                            <h:column>
                                <f:facet name="header">country</f:facet>
                                #{_facility.country}
                            </h:column>
                            <h:column>
                                <f:facet name="header">county</f:facet>
                                #{_facility.county}
                            </h:column>
                            <ui:remove>
                                <h:column>
                                    <f:facet name="header">description</f:facet>
                                    #{_facility.description}
                                </h:column>
                            </ui:remove>
                            <h:column>
                                <f:facet name="header">name</f:facet>
                                #{_facility.name}
                            </h:column>
                            <h:column>
                                <f:facet name="header">phone</f:facet>
                                #{_facility.phone}
                            </h:column>
                            <h:column>
                                <f:facet name="header">priceRange</f:facet>
                                #{_facility.priceRange}
                            </h:column>
                            <h:column>
                                <f:facet name="header">state</f:facet>
                                #{_facility.state}
                            </h:column>
                            <h:column>
                                <f:facet name="header">type</f:facet>
                                #{_facility.type}
                            </h:column>
                            <h:column>
                                <f:facet name="header">uri</f:facet>
                                #{_facility.uri}
                            </h:column>
                            <h:column>
                                <f:facet name="header">zip</f:facet>
                                #{_facility.zip}
                            </h:column>
                            <h:column>
                                <f:facet name="header">action</f:facet>
                                <h:link outcome="/Facility.xhtml"
                                        id="viewfacility"
                                        value="View">
                                    <f:param name="facilityId"
                                             value="#{_facility.id}"/>
                                </h:link>
                            </h:column>
                        </rich:dataTable>

                        <div class="actionButtons">
                            <h:button value="Select facility"
                                      outcome="/FacilityList.xhtml">
                            </h:button>
                        </div>

                    </div>
                </rich:tab>

                <rich:tab header="holes">
                    <div class="association" id="holesChildren">

                        <h:outputText value="There are no holes associated with this course."
                                      rendered="#{empty courseAction.holes}"/>

                        <rich:dataTable value="#{courseAction.holes}"
                                        var="hole"
                                        rendered="#{not empty courseAction.holes}"
                                        rowClasses="rvgRowOne,rvgRowTwo"
                                        id="holesTable">
                            <h:column>
                                <f:facet name="header">id</f:facet>
                                <h:outputText value="#{hole.id}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">ladiesHandicap</f:facet>
                                <h:outputText value="#{hole.ladiesHandicap}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">ladiesPar</f:facet>
                                <h:outputText value="#{hole.ladiesPar}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">mensHandicap</f:facet>
                                <h:outputText value="#{hole.mensHandicap}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">mensPar</f:facet>
                                <h:outputText value="#{hole.mensPar}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">name</f:facet>
                                <h:outputText value="#{hole.name}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">number</f:facet>
                                <h:outputText value="#{hole.number}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">action</f:facet>
                                <h:link outcome="/Hole.xhtml"
                                        id="selecthole"
                                        value="View">
                                    <f:param name="holeId"
                                             value="#{hole.id}"/>
                                </h:link>
                            </h:column>
                        </rich:dataTable>

                    </div>

                    <f:subview rendered="#{courseAction.managed}" id="holes">
                        <div class="actionButtons">
                            <h:button id="addhole"
                                      value="Add hole"
                                      includeViewParams="true"
                                      outcome="/HoleEdit.xhtml">
                            </h:button>
                        </div>
                    </f:subview>
                </rich:tab>

                <rich:tab header="teeSets">
                    <div class="association" id="teeSetsChildren">

                        <h:outputText value="There are no teeSets associated with this course."
                                      rendered="#{empty courseAction.teeSets}"/>

                        <rich:dataTable value="#{courseAction.teeSets}"
                                        var="teeSet"
                                        rendered="#{not empty courseAction.teeSets}"
                                        rowClasses="rvgRowOne,rvgRowTwo"
                                        id="teeSetsTable">
                            <h:column>
                                <f:facet name="header">id</f:facet>
                                <h:outputText value="#{teeSet.id}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">color</f:facet>

                                <div title="#{teeSet.color}"
                                     style="background-color: #{teeSet.color}; height: 1em; width: 1em; outline: 1px solid black; margin: 0 auto;"></div>
                            </h:column>
                            <h:column>
                                <f:facet name="header">ladiesCourseRating</f:facet>
                                <h:outputText value="#{teeSet.ladiesCourseRating}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">ladiesSlopeRating</f:facet>
                                <h:outputText value="#{teeSet.ladiesSlopeRating}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">mensCourseRating</f:facet>
                                <h:outputText value="#{teeSet.mensCourseRating}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">mensSlopeRating</f:facet>
                                <h:outputText value="#{teeSet.mensSlopeRating}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">name</f:facet>
                                <h:outputText value="#{teeSet.name}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">position</f:facet>
                                <h:outputText value="#{teeSet.position}"/>
                            </h:column>
                            <h:column>
                                <f:facet name="header">action</f:facet>
                                <h:link outcome="/TeeSet.xhtml"
                                        id="selectteeSet"
                                        value="View">
                                    <f:param name="teeSetId"
                                             value="#{teeSet.id}"/>
                                </h:link>
                            </h:column>
                        </rich:dataTable>

                    </div>

                    <f:subview rendered="#{courseAction.managed}" id="teeSets">
                        <div class="actionButtons">
                            <h:button id="addteeSet"
                                      value="Add teeSet"
                                      includeViewParams="true"
                                      outcome="/TeeSetEdit.xhtml">
                            </h:button>
                        </div>
                    </f:subview>
                </rich:tab>
            </rich:tabPanel>
        </h:form>
    </ui:define>

</ui:composition>
