<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:rich="http://richfaces.org/rich"
                xmlns:a="http://richfaces.org/a4j"
                xmlns:open18="http://java.sun.com/jsf/composite/components"
                template="layout/template.xhtml">

    <ui:define name="body">

        <h:messages globalOnly="true" styleClass="message" errorClass="errormsg" infoClass="infomsg" warnClass="warnmsg"
                    id="globalMessages"/>

        <h:form id="facilitySearch" styleClass="edit">

            <rich:collapsiblePanel id="searchPanel" header="Facility search parameters" switchType="client" expanded="true">

                <open18:input id="addressDecorator" inputId="address" label="address">
                    <h:inputText id="address" value="#{facilityAction.facility.address}"/>
                </open18:input>

                <open18:input id="cityDecorator" inputId="city" label="city">
                    <h:inputText id="city" value="#{facilityAction.facility.city}"/>
                </open18:input>

                <open18:input id="countryDecorator" inputId="country" label="country">
                    <h:inputText id="country" value="#{facilityAction.facility.country}"/>
                </open18:input>

                <open18:input id="countyDecorator" inputId="country" label="county">
                    <h:inputText id="county" value="#{facilityAction.facility.county}"/>
                </open18:input>

                <open18:input id="descriptionDecorator" inputId="description" label="description">
                    <h:inputText id="description" value="#{facilityAction.facility.description}"/>
                </open18:input>

                <open18:input id="nameDecorator" inputId="name" label="name">
                    <h:inputText id="name" value="#{facilityAction.facility.name}"/>
                </open18:input>

                <open18:input id="phoneDecorator" inputId="phone" label="phone">
                    <h:inputText id="phone" value="#{facilityAction.facility.phone}"/>
                </open18:input>

                <open18:input id="stateDecorator" inputId="state" label="state">
                    <h:inputText id="state" value="#{facilityAction.facility.state}"/>
                </open18:input>

                <open18:input id="typeDecorator" inputId="type" label="type">
                    <h:inputText id="type" value="#{facilityAction.facility.type}"/>
                </open18:input>

                <open18:input id="uriDecorator" inputId="uri" label="uri">
                    <h:inputText id="uri" value="#{facilityAction.facility.uri}"/>
                </open18:input>

                <open18:input id="zipDecorator" inputId="zip" label="zip">
                    <h:inputText id="zip" value="#{facilityAction.facility.zip}"/>
                </open18:input>

                <div class="actionButtons">
                    <h:commandButton id="search" value="Search" action="#{facilityAction.search}"/>
                </div>
            </rich:collapsiblePanel>

            <br clear="all"/>

            <rich:panel>
                <f:facet name="header">Facility search results</f:facet>

                <div class="results" id="facilityAction">

                    <h:outputText value="The facility search returned no results."
                                  rendered="#{empty facilityAction.resultList}"/>

                    <rich:dataTable id="facilityListTable"
                                    var="_facility"
                                    value="#{facilityAction.resultList}"
                                    rows="10"
                                    rendered="#{not empty facilityAction.resultList}">
                        <rich:column sortBy="#{_facility.id}">
                            <f:facet name="header">
                                <a:commandLink styleClass="columnHeader" value="id"/>
                            </f:facet>
                            #{_facility.id}
                        </rich:column>
                        <rich:column sortBy="#{_facility.address}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="address"/>
                            </f:facet>
                            #{_facility.address}
                        </rich:column>
                        <rich:column sortBy="#{_facility.city}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="city"/>
                            </f:facet>
                            #{_facility.city}
                        </rich:column>
                        <rich:column sortBy="#{_facility.country}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="country"/>
                            </f:facet>
                            #{_facility.country}
                        </rich:column>
                        <rich:column sortBy="#{_facility.county}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="county"/>
                            </f:facet>
                            #{_facility.county}
                        </rich:column>
                        <rich:column sortBy="#{_facility.name}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="name"/>
                            </f:facet>
                            <h:outputLink value="#{_facility.uri}"
                                          rendered="#{not empty _facility.uri}">#{_facility.name}</h:outputLink>
                            <h:outputText value="#{_facility.uri}"
                                          rendered="#{empty _facility.uri}">#{_facility.name}</h:outputText>
                        </rich:column>
                        <rich:column sortBy="#{_facility.phone}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="phone"/>
                            </f:facet>
                            #{_facility.phone}
                        </rich:column>
                        <rich:column sortBy="#{_facility.priceRange}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="priceRange"/>
                            </f:facet>
                            #{_facility.priceRange}
                        </rich:column>
                        <rich:column sortBy="#{_facility.state}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="state"/>
                            </f:facet>
                            #{_facility.state}
                        </rich:column>
                        <rich:column sortBy="#{_facility.type}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="type"/>
                            </f:facet>
                            #{_facility.type}
                        </rich:column>
                        <rich:column sortBy="#{_facility.zip}">
                            <f:facet name="header">
                                <h:outputText styleClass="columnHeader" value="zip"/>
                            </f:facet>
                            #{_facility.zip}
                        </rich:column>
                        <rich:column>
                            <f:facet name="header">action</f:facet>
                            <h:link outcome="/Facility.xhtml" value="View">
                                <f:param name="facilityId" value="#{_facility.id}"/>
                                <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/>
                            </h:link>
                            |
                            <h:link id="selectLink" outcome="/FacilityEdit.xhtml"
                                    value="Select">
                                <f:param name="facilityId" value="#{_facility.id}"/>
                                <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/>
                            </h:link>
                        </rich:column>
                        <f:facet name="footer">
                            <rich:dataScroller for="facilityListTable" maxPages="5"/>
                        </f:facet>
                    </rich:dataTable>
                </div>
            </rich:panel>

            <div class="actionButtons">
                <h:button outcome="/FacilityEdit.xhtml"
                          id="create"
                          value="Create facility">
                    <f:param name="cid" value="#{javax.enterprise.context.conversation.id}"/>
                </h:button>
            </div>

        </h:form>

    </ui:define>

</ui:composition>

